<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		<template id="report_notaryquotation_document">
			<t t-call="report.external_layout">
				<div class="page">
					<div class="oe_structure" />
					<div class="col-xs-6 col-xs-offset-3">
						<h3>Devis des Frais de Dossier</h3>
					</div>
					<div class="row">
						<div class="col-xs-6">
							<strong>Le Client :</strong>
							<div t-field="o.partner_invoice_id"
								t-field-options='{"widget": "contact", "fields":
                                ["address", "name", "phone", "fax"], "no_marker": true}' />
							<p t-if="o.partner_id.vat">
								VAT:
								<span t-field="o.partner_id.vat" />
							</p>
							<div t-if="o.partner_shipping_id != o.partner_invoice_id"
								class="mt8">
								<strong>Shipping address:</strong>
								<div t-field="o.partner_shipping_id"
									t-field-options='{"widget": "contact", "fields":
                                    ["address", "name", "phone", "fax"], "no_marker": true}' />
								<p t-if="o.partner_id.vat">
									VAT:
									<span t-field="o.partner_id.vat" />
								</p>
							</div>
						</div>
						<div class="col-xs-5 col-xs-offset-1">
							<span t-if="o.date_order">
								<strong>Le:</strong>
							</span>
							<span t-field="o.date_order" />
						</div>
						<div class="col-xs-5 col-xs-offset-1">
							<span t-if="o.user_id">
								<strong>Resp. Devis :</strong>
							</span>
							<span t-field="o.user_id.name" />
						</div>
					</div>

					<h2>
						<span t-if="o.state not in ['draft','sent']">Dossier N°</span>
						<span t-if="o.state in ['draft','sent']">Dossier N°</span>
						<span t-field="o.name" />
					</h2>
					
					<h2>
						<span t-if="o.state not in ['draft','sent']">Répertoire N°</span>
						<span t-if="o.state in ['draft','sent']">Répertoire N°</span>
						<span t-field="o.client_order_ref" />
					</h2>

					<div class="row mt32 mb32" id="informations">
						<div t-if="o.nature_acte" class="col-xs-3">
							<strong>Nature de l'acte:</strong>
							<p t-field="o.nature_acte" />
						</div>

						<div t-if="o.type_bien" class="col-xs-3">
							<strong>Type de Bien:</strong>
							<p t-field="o.type_bien" />
						</div>

						<div t-if="o.tf_mee" class="col-xs-3">
							<strong>Titre Foncier:</strong>
							<p t-field="o.tf_mee" />
						</div>

						<div t-if="o.price_sell" class="col-xs-3">
							<strong>Prix de Vente:</strong>
							<p t-field="o.price_sell" />
						</div>

					</div>

					<table class="table table-condensed">
						<thead>
							<tr>
								<th>Description</th>
								<th class="text-left">Pourcentage</th>
								<th class="text-right">Prix de Base</th>
								<th class="text-right">Taxes</th>
								<th groups="sale.group_discount_per_so_line">Disc.(%)</th>
								<th class="text-right">Prix</th>
							</tr>
						</thead>
						<tbody class="sale_tbody">
							<tr t-foreach="o.order_line" t-as="l">
								<td>
									<span t-field="l.name" />
								</td>
								<td class="text-left">
									<span t-esc="', '.join(map(lambda x: x.name, l.percentage_id))" />
								</td>
								<td class="text-right">
									<span t-field="l.price_unit" />
								</td>
								<td class="text-right">
									<span t-esc="', '.join(map(lambda x: x.name, l.tax_id))" />
								</td>
								<td groups="sale.group_discount_per_so_line">
									<span t-field="l.discount" />
								</td>
								<td class="text-right">
									<span t-field="l.price_subtotal"
										t-field-options='{"widget": "monetary", "display_currency":
                                        "o.pricelist_id.currency_id"}' />
								</td>
							</tr>
						</tbody>
					</table>

					<div class="row">
						<div class="col-xs-4 pull-right">
							<table class="table table-condensed">
								<tr class="border-black">
									<td>
										<strong>Total sans Taxes</strong>
									</td>
									<td class="text-right">
										<span t-field="o.amount_untaxed"
											t-field-options='{"widget": "monetary", "display_currency":
                                            "o.pricelist_id.currency_id"}' />
									</td>
								</tr>
								<tr>
									<td>Taxes</td>
									<td class="text-right">
										<span t-field="o.amount_tax"
											t-field-options='{"widget": "monetary", "display_currency":
                                            "o.pricelist_id.currency_id"}' />
									</td>
								</tr>
								<tr class="border-black">
									<td>
										<strong>Total</strong>
									</td>
									<td class="text-right">
										<span t-field="o.amount_total"
											t-field-options='{"widget": "monetary", "display_currency":
                                            "o.pricelist_id.currency_id"}' />
									</td>
								</tr>
							</table>
						</div>
					</div>
					<div class="col-xs-6 col-xs-offset-1">
						<strong t-if="o.amount_text">Arrêté à la somme de:</strong>
						<p t-field="o.amount_text" />
					</div>

					<p t-field="o.note" />
					<p t-if="o.payment_term.note">
						<strong>Payment Term:</strong>
						<span t-field="o.payment_term.note" />
					</p>
					<div class="oe_structure" />
				</div>
			</t>
		</template>

		<template id="report_notaryquotation">
			<t t-call="report.html_container">
				<t t-foreach="doc_ids" t-as="doc_id">
					<t
						t-raw="translate_doc(doc_id, doc_model, 'partner_id.lang', 'notaire.report_notaryquotation_document')" />
				</t>
			</t>
		</template>
	</data>
</openerp>
